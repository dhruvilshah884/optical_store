<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Meta Tag -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="BigBazar - Multipurpose Ecommerce HTML Template">

    <meta name="author" content="root">
    <title>BigBazar - Payment Report</title>

    <!-- Favicon -->
    <link rel="shortcut icon" href="/images/favicon.png">

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Jost:wght@100;200;300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">

    <!--  CSS Style -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/all.min.css">
    <link rel="stylesheet" href="/css/animate.min.css">
    <link rel="stylesheet" href="/webfonts/flaticon/flaticon.css">
    <link rel="stylesheet" href="/css/owl.carousel.min.css">
    <link rel="stylesheet" href="/css/jquery.fancybox.min.css">
    <link rel="stylesheet" href="/css/layerslider.css">
    <link rel="stylesheet" href="/css/template.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/category/optical-shop.css">

    <style>

        form {
        width: 400px;
        margin: auto;
        }

        .total-label {
            display: block;
            text-align: center;
            margin-bottom: 10px;
            margin-top: -20px;
        }
    </style>

</head>

<body>
    

        <!-- breadcrumb -->
        <div class="full-row bg-light py-5">
            <div class="container">
                <div class="row text-secondary">
                    <div class="col-sm-6">
                        <h3 class="mb-2 text-secondary">Payment Report</h3>
                    </div>
                    <div class="col-sm-6">
                        <nav aria-label="breadcrumb" class="d-flex justify-content-sm-end align-items-center h-100">
                            <ol class="breadcrumb mb-0 d-inline-flex bg-transparent p-0">
                                <li class="breadcrumb-item"><a href="/admin"><i
                                            class="fas fa-home me-1"></i>Home</a></li>
                                <li class="breadcrumb-item"><a href="/productreport">Products Report</a></li>
                                <li class="breadcrumb-item"><a href="/report">User Report</a></li>
                                <li class="breadcrumb-item"><a href="/contactreport">Contact Report</a></li>
                                <li class="breadcrumb-item active" aria-current="page">Payment Report</li>
                            </ol>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
        <!-- breadcrumb -->


            <!-- searching form start -->
            <form class="mt-4 mb-4" action="/paymentreport" method="get">
                <div class="table-responsive">
                    <table class="table">
                        <tbody>
                            <tr>
                                <td>
                                    <label for="startDate" class="form-label">Start Date:</label>
                                </td>
                                <td>
                                    <input type="date" class="form-control" name="startDate" id="startDate" required>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label for="endDate" class="form-label">End Date:</label>
                                </td>
                                <td>
                                    <input type="date" class="form-control" name="endDate" id="endDate" required>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <button type="submit" class="btn btn-primary w-100">Search</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </form>
            <!-- searching form end -->

            <label class="total-label" for="Total">Total: <%= count %></label>

            <!-- table start -->
            <table class="table table-striped table-bordered text-center" style="margin: auto;">
                <thead class="thead-dark bg-primary">
                    <tr>
                        <th class="text-secondary">User</th>
                        <th class="text-secondary">Amount</th>
                        <th class="text-secondary">Product Details</th>
                        <th class="text-secondary">Transaction ID</th>
                        <th class="text-secondary">Date</th>
                        <th class="text-secondary">Action</th>
                    </tr>
                </thead>
                <tbody>
                    <% payments.forEach(payment => { %>
                    <tr>
                        <td><%= payment.userID ? payment.userID.username : 'Unknown User' %></td>
                        <td>â‚¹<%= payment.amount %></td>
                        <td>
                            <% payment.products.forEach((product, index) => { %>
                                <% if (product.productID) { %>
                                    <%= product.productID.product_name %>: <%= product.quantity %><br>
                                <% } %>
                            <% }) %>
                        </td>
                        <td><%= payment._id %></td>
                        <td><%= payment.paymentDate.toDateString() %></td>
                        <td class="align-middle">
                            <a href="/delete/payment/<%= payment._id %>" onclick="return confirm('Are you sure you want to delete this user?');">
                                <button class="btn btn-outline-primary border border-primary rounded">Delete</button>
                            </a>
                        </td>
                    </tr>
                    <% }) %>
                </tbody>
            </table>
            
            <!-- table end -->





         <!-- ============ footer start ======================= -->
         <%- include('../partials/footer') %>
         <!-- ================= footer end ====================== -->

         <!-- Include Scripts -->
         <script src="/js/jquery.min.js"></script>
         <script src="/js/greensock.js"></script>
         <script src="/js/layerslider.transitions.js"></script>
         <script src="/js/layerslider.kreaturamedia.jquery.js"></script>
         <script src="/js/popper.min.js"></script>
         <script src="/js/bootstrap.min.js"></script>
         <script src="/js/owl.carousel.min.js"></script>
         <script src="/js/wow.js"></script>
         <script src="/js/jquery.fancybox.min.js"></script>
         <script src="/js/jquery.countdown.js"></script>
         <script src="/js/paraxify.js"></script>
         <script src="/js/custom.js"></script>

         <!-- Initializing the slider -->
         <script>
             $(document).ready(function () {
                 $('#slider').layerSlider({
                     sliderVersion: '6.0.0',
                     type: 'responsive',
                     responsiveUnder: 0,
                     maxRatio: 1,
                     hideUnder: 0,
                     hideOver: 100000,
                     skin: 'v6',
                     navStartStop: false,
                     skinsPath: '/skins/',
                     height: 960
                 });
             });
         </script>


</body>

</html>